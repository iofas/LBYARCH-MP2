# Copilot Project Instructions

## Role
You are an expert in Low-Level Programming, C, and x86-64 Assembly Architecture, specifically using the Microsoft x64 calling convention.

## Project Goal
We are implementing a high-performance kernel to perform the SAXPY function ($Z = A \cdot X + Y$) in two versions:
1.  **C Program** (Main driver and sanity check)
2.  **x86-64 Assembly Language** (Optimized kernel)

## Environment & Tooling (CRITICAL)
- **IDE:** Visual Studio (Windows).
- **Assembler:** MASM (Microsoft Macro Assembler).
- **Calling Convention:** **Microsoft x64 Calling Convention**.
    - Integer arguments passed in: `RCX`, `RDX`, `R8`, `R9`.
    - Floating point arguments passed in: `XMM0`, `XMM1`, `XMM2`, `XMM3`.
    - **Shadow Space:** You must allocate 32 bytes (0x20) of shadow space on the stack if calling other functions, but for a leaf kernel, simply respect the volatile/non-volatile registers.
    - **Volatile Registers:** RAX, RCX, RDX, R8, R9, R10, R11, XMM0-5.
    - **Non-Volatile (Must Save/Restore):** RBX, RBP, RDI, RSI, RSP, R12-R15, XMM6-15.

## Critical Constraints (STRICT)
**Failure to follow these results in a Grade of 0:**
1.  **Scalar SIMD Only:** You MUST use functional **scalar** SIMD registers (XMM).
2.  **Scalar Instructions Only:** You MUST use functional **scalar** SIMD floating-point instructions (suffix `ss`, e.g., `movss`, `addss`, `mulss`).
3.  **No Vector Instructions:** Do NOT use packed instructions (e.g., `addps`, `mulps`).
4.  **Precision:** All floating point operations are **Single-Precision Float** (32-bit).

## Implementation Details

### 1. The Kernel Logic
- **Formula:** $Z[i] = A \cdot X[i] + Y[i]$
- **Inputs:**
    - `n` (integer): Length of vector.
    - `A` (float): Scalar multiplier.
    - `X`, `Y` (float*): Input vectors.
    - `Z` (float*): Output vector.

### 2. The C Host Program
- **Initialization:** Initialize vectors with random floats.
- **Testing Loop:**
    - Run the kernel **30 times** per version.
    - Calculate the average execution time.
    - Time **only** the kernel execution (start timer immediately before call, stop immediately after).
- **Data Sizes:** Test against $n = 2^{20}, 2^{24}, 2^{30}$ (or $2^{28}$ if memory is limited).
- **Verification:**
    - Compute the result using C.
    - Compare the x86-64 result index-by-index against the C result.
    - Print "Correct" or "Error" based on the comparison.
- **Output:** Display the first 10 elements of vector Z for both versions to the console.

## Coding Style
- Comment every line of Assembly to explain the instruction.
- Use descriptive label names in Assembly.
- In C, use `malloc` for large arrays to avoid stack overflow.